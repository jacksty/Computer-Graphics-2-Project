attribute vec2 a_position;

uniform mat4 viewProjMat;

uniform sampler2D postex;
uniform sampler2D veltex;

varying float v_life;

void main(){
    
    vec4 c = texture2D(postex,a_position);
    vec4 p = vec4(c.xyz,1.0);
    
    c = texture2D(veltex,a_position);
    v_life = c.w;
    
    //this isn't really necessary since we draw the points with
    //alpha=0 when their life is exhausted
    if( v_life <= 0.0 )
        gl_Position = vec4(2.0,2.0,2.0,1.0);
    else
        gl_Position=p*viewProjMat;
    
    gl_PointSize=4.0;
    
}
